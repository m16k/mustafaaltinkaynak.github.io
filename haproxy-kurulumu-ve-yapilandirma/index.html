<!DOCTYPE html>
<html lang="tr">
<title>HAProxy Kurulumu ve Yapılandırma | Mustafa ALTINKAYNAK | Siber Güvenlik</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="HAProxy nedir? HAProxy (High Availability Proxy), bir yük dengeleme görev yöneticisidir. Birçok servis için yük dengeleme, yüksek erişilebilirlik ve proxy gi...">
<meta name="author" content="Mustafa ALTINKAYNAK">
<meta name="generator" content="Jekyll v4.0.0">
<link rel="canonical" href="http://localhost:4000/haproxy-kurulumu-ve-yapilandirma/">

<link rel="stylesheet" href="/assets/css/index.css">

<link rel="stylesheet" href="/assets/css/classes.css">
<link rel="stylesheet" href="/assets/css/sidebar.css" media="screen and (min-width: 70em)">
<link rel="alternate" href="/feed.xml" type="application/atom+xml" title="Mustafa ALTINKAYNAK | Siber Güvenlik">




<header class="icons">
    <img src="/assets/images/mustafa-altinkaynak-profil.jpg" style="border-radius:50%;" alt="Mustafa Altınkaynak " class="landing-profile-pic">
  
  
    
  <nav>
  <a aria-label="Anasayfa" href="/" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#home"></use></svg><span aria-hidden="true" class="hidden">Anasayfa</span></a>
  <a aria-label="Hakkımda" href="/pages/about.html" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#address-card"></use></svg><span aria-hidden="true" class="hidden">Hakkımda</span></a>
  <a aria-label="İletişim" href="/pages/contact.html" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#envelope"></use></svg><span aria-hidden="true" class="hidden">İletişim</span></a>
  
  </nav>


    
  <nav>
  <a aria-label="Instagram" target="_blank" href="https://www.instagram.com/mustafaaltinkaynakcom" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#instagram"></use></svg><span aria-hidden="true" class="hidden">Instagram</span></a>
  <a aria-label="Twitter" target="_blank" href="https://www.twitter.com/m_altinkaynak" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#twitter"></use></svg><span aria-hidden="true" class="hidden">Twitter</span></a>
  <a aria-label="Github" target="_blank" href="https://www.github.com/mustafaaltinkaynak" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#github"></use></svg><span aria-hidden="true" class="hidden">Github</span></a>
  <a aria-label="LinkedIn" target="_blank" href="https://www.linkedin.com/in/altinkaynak" ><svg aria-hidden="true" ><use xlink:href="/assets/fontawesome/icons.svg#linkedin"></use></svg><span aria-hidden="true" class="hidden">LinkedIn</span></a>
  
  </nav>


  
  
    <div class="hidden description"></div>
  
</header>

<article>
  <header>
  
  <h1><a href="/haproxy-kurulumu-ve-yapilandirma/">HAProxy Kurulumu ve Yapılandırma</a></h1><time datetime="2016-09-24T00:00:00+03:00">September 24, 2016</time>
</header>

  <h2 id="haproxy-nedir">HAProxy nedir?</h2>
<p>HAProxy (High Availability Proxy), bir yük dengeleme görev yöneticisidir. Birçok servis için yük dengeleme, yüksek erişilebilirlik ve proxy gibi hizmetleri ücretsiz, güvenli olarak sunmaktadır. Stabil versiyonu 1.6’dır.</p>

<p>Bu yazı da ise Ubuntu üzerine HAProxy 1.4.24 kurulumu gerçekleştirerek aşağıda yer alan yapıyı oluşturacağız.</p>

<p><img src="/assets/images/haproxy-yapi.png" alt="" /></p>

<p><strong>HAProxy sunucusu:</strong> 192.168.1.200</p>

<p><strong>Webserver 1:</strong> 192.168.1.201</p>

<p><strong>Webserver 2:</strong> 192.168.1.202</p>

<p>Tüm sunuculara web server kurulumunu gerçekleştirdim.</p>

<h2 id="haproxy-kurulumu">HAProxy kurulumu</h2>

<p>Ubuntu deposunda tanımlı olduğundan dolayı direkt apt-get ile kurabilirsiniz.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mustafa@altinkaynak:/# apt-get install haproxy
</code></pre></div></div>

<p>Kurulum işleminin ardından aşağıdaki komut ile birlikte versiyon kontrolü sağlayabilirsiniz.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mustafa@altinkaynak:/# haproxy -v
HA-Proxy version 1.4.24 2013/06/17
Copyright 2000-2013 Willy Tarreau &lt;w@1wt.eu&gt;
</code></pre></div></div>

<p>HAProxy’i etkinleştirmek için /etc/default/haproxy dosyasında yer alan ENABLED değerini 1 olarak değiştirmeniz gerekmektedir.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ENABLED=1
</code></pre></div></div>

<p>Artık HAProxy servisi için etkinlikler geldi.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mustafa@altinkaynak:/# service haproxy
Usage: /etc/init.d/haproxy {start|stop|reload|restart|status}
</code></pre></div></div>

<h2 id="haproxy-yapılandırma">HAProxy yapılandırma</h2>

<p>Herşeye başlamadan önce mevcut HAProxy konfigurasyon dosyasını yedekleyelim.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mv /etc/haproxy/haproxy.cfg{,.original}
</code></pre></div></div>

<p>Artık <strong>haproxy.cfg</strong> adında yeni bir konfigurasyon dosyası oluşturarak burada işlem gerçekleştirelim.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>global
        log /dev/log   local0
        log 127.0.0.1   local1 notice
        maxconn 4096
        user haproxy
        group haproxy
        daemon

defaults
        log     global
        mode    http
        option  httplog
        option  dontlognull
        retries 3
        option redispatch
        maxconn 2000
        contimeout     5000
        clitimeout     50000
        srvtimeout     50000

listen altinkaynak 127.0.0.1:80
    mode http
    stats enable
    stats uri /haproxy?stats
    balance roundrobin
    option httpclose
    option forwardfor
    server webserver01 192.168.1.201:80 check
    server webserver02 192.168.1.202:80 check
</code></pre></div></div>

<p>Bu sürüm için geçerli konfigurasyon açıklamasına <a href="http://www.haproxy.org/download/1.4/doc/configuration.txt">buradan</a> ulaşabilirsiniz.</p>

<p>Şimdi HAProxy dashboard sayfamıza göz atalım. Aşağıdaki göreceğiz üzere tüm servislerimiz yerlerini almış ve UP/DOWN durumları zamansal olarak gösterilmiştir. Servisler üzerinde açılan session sayısını da görebilmekteyiz.</p>

<p><img src="/assets/images/haproxy-dashboard.png" alt="" /></p>

<p>Sunucuların up/down durumlarında e-posta bildirimi almak isteyebilirsiniz. O zaman güzel bir haber vereyim. HAProxy 1.6 sürümünde bildirim desteği gelmiştir. Ancak 1.4 sürümünde olmadığından dolayı bu yazıda yer veremiyorum.</p>

<p>HAProxy’in bize sunmuş olduğu yük dengelemeyi de test edelim. Artık tüm trafiği HAProxy sunucusu üzerine (192.168.1.200) üzerine yönlendiriyoruz. Ben farkı anlayabilmek açısından giriş sayfalarına hangi sunucuya bağlantı yaptığımı yazdırdım.</p>

<p><img src="/assets/images/sunucular.png" alt="" /></p>

<p>Sonuç olarak HAProxy en uygun olan sunucuya beni yönlendirdi.</p>

  
</article>


  <footer class="related">
    <div class="previous"><span>Previous Post</span><a href="/nagios-uzak-sunucu-ekleme/">Nagios Uzak Sunucu Ekleme</a></div>
    <div class="next"><span>Next Post</span><a href="/ufw-kurulumu-ve-yapilandirma/">UFW Kurulumu ve Yapılandırma</a></div>
  </footer>



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-101755558-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-101755558-3');
</script>
</html>
